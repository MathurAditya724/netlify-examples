---
import Layout from "../layouts/Layout.astro";
import { getCurrentUser } from "../utils/auth";

const currentUser = await getCurrentUser({ cookies: Astro.cookies });
console.log(currentUser);
---

<Layout title="User Image Uploads with Astro + Netlify Blobs">
  <section>
    <h1>Example: User-generated image uploads</h1>

    {
      currentUser && (
        <>
          <section>
            <p>
              <strong>Current user</strong>
            </p>
            <ul>
              <li>
                Name: <code>{currentUser.name}</code>.
              </li>
              <li>
                Wmail: <code>{currentUser.email}</code>.
              </li>
            </ul>
          </section>
          <section>
            <p>Form goes here ...</p>
          </section>
        </>
      )
    }

    {
      !currentUser && (
        <div>
          <p>
            You are not signed in.
            <a href="/login">Create account and sign in process.</a>
          </p>
        </div>
      )
    }
  </section>
</Layout>
